{
    "version": 3,
    "cmakeMinimumRequired": {
      "major": 3,
      "minor": 24,
      "patch": 0
    },
    "configurePresets": [
      {
        "name": "base",
        "hidden": true, // Hide this base preset from IDE lists / --list-presets
        "generator": "Ninja", // Recommended generator if available
        "binaryDir": "${sourceDir}/build/${presetName}",
        "cacheVariables": {
          "CMAKE_CXX_STANDARD": "17",
          "CMAKE_CXX_STANDARD_REQUIRED": "ON",
          "CMAKE_CXX_EXTENSIONS": "OFF",
          // Default component builds (can be overridden by inheriting presets)
          "MEMILIO_BUILD_TESTS": "ON",
          "MEMILIO_BUILD_EXAMPLES": "ON",
          "MEMILIO_BUILD_MODELS": "ON",
          "MEMILIO_BUILD_SIMULATIONS": "OFF",
          "MEMILIO_BUILD_BENCHMARKS": "OFF",
          // Default features
          "MEMILIO_ENABLE_WARNINGS": "ON",
          "MEMILIO_ENABLE_WARNINGS_AS_ERRORS": "ON", // Enforce quality by default
          // Default dependency handling (can be overridden)
          "MEMILIO_USE_BUNDLED_EIGEN": "ON",
          "MEMILIO_USE_BUNDLED_BOOST": "ON",
          "MEMILIO_USE_BUNDLED_JSONCPP": "ON",
          "MEMILIO_USE_BUNDLED_SPDLOG": "ON"
        }
      },
      {
        "name": "release",
        "displayName": "Release Build",
        "description": "Standard optimized release build with tests and examples.",
        "inherits": "base",
        "cacheVariables": {
          "CMAKE_BUILD_TYPE": "Release"
        }
      },
      {
        "name": "debug",
        "displayName": "Debug Build",
        "description": "Unoptimized debug build with tests and examples.",
        "inherits": "base",
        "cacheVariables": {
          "CMAKE_BUILD_TYPE": "Debug",
          "MEMILIO_ENABLE_WARNINGS_AS_ERRORS": "OFF" // Often OFF for debug to iterate faster
        }
      },
      {
        "name": "debug-asan",
        "displayName": "Debug Build (Address Sanitizer)",
        "description": "Debug build with Address and Undefined Behavior sanitizers.",
        "inherits": "debug", // Inherit from the debug preset
        "cacheVariables": {
          "MEMILIO_SANITIZE_ADDRESS": "ON",
          "MEMILIO_SANITIZE_UNDEFINED": "ON" // Often enabled together with ASan
        },
        "condition": { // Only show/enable this preset if compiler is GCC/Clang
           "type": "not",
           "operand": { "type": "equals", "lhs": "${hostSystemName}", "rhs": "Windows" }
        }
      },
      {
        "name": "release-omp",
        "displayName": "Release Build (OpenMP)",
        "description": "Optimized release build with OpenMP enabled.",
        "inherits": "release",
        "cacheVariables": {
          "MEMILIO_ENABLE_OPENMP": "ON"
        }
      },
      {
        "name": "release-mpi",
        "displayName": "Release Build (MPI)",
        "description": "Optimized release build with MPI enabled.",
        "inherits": "release",
        "cacheVariables": {
          "MEMILIO_ENABLE_MPI": "ON"
          // Consider setting MPI launchers if needed via environment:
          //"environment": {
          //  "MPIEXEC_PREFLAGS": "--some-flag",
          //  "MPIEXEC_POSTFLAGS": "--another-flag"
          //}
        }
      },
       {
        "name": "release-ipopt",
        "displayName": "Release Build (Ipopt)",
        "description": "Optimized release build with Ipopt enabled.",
        "inherits": "release",
        "cacheVariables": {
          "MEMILIO_ENABLE_IPOPT": "ON"
        }
      }
      // Add presets for other combinations (e.g., MPI+OpenMP, different generators like "Unix Makefiles")
    ],
    "buildPresets": [
      // Simple build presets linking to configure presets
      // Allows 'cmake --build --preset release' etc.
      { "name": "release", "configurePreset": "release" },
      { "name": "debug", "configurePreset": "debug" },
      { "name": "debug-asan", "configurePreset": "debug-asan" },
      { "name": "release-omp", "configurePreset": "release-omp" },
      { "name": "release-mpi", "configurePreset": "release-mpi" },
      { "name": "release-ipopt", "configurePreset": "release-ipopt" }
    ],
    "testPresets": [
      // Simple test presets linking to configure presets
      // Allows 'ctest --preset release' etc. (after building)
      // outputOnFailure shows more detail if a test fails
      { "name": "release", "configurePreset": "release", "output": { "outputOnFailure": true } },
      { "name": "debug", "configurePreset": "debug", "output": { "outputOnFailure": true } },
      { "name": "debug-asan", "configurePreset": "debug-asan", "output": { "outputOnFailure": true } },
      { "name": "release-omp", "configurePreset": "release-omp", "output": { "outputOnFailure": true } },
      { "name": "release-mpi", "configurePreset": "release-mpi", "output": { "outputOnFailure": true } },
      { "name": "release-ipopt", "configurePreset": "release-ipopt", "output": { "outputOnFailure": true } }
    ]
  }